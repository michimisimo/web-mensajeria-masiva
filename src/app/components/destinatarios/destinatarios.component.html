<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<div class="page">
    <div class="top-elements">
        <div class="left-elements">
            <button class="icono-archivo">
                <i class="fas fa-download" (click)="descargarPlantilla()"></i>
            </button>
            <h4 class="upload-title">Descargar plantilla excel</h4>
        </div>
        <div class="right-elements">
            <h4 class="upload-title">Cargar múltiples destinatarios con archivo excel (.xlsx)</h4>
            <div class="drop">
                
                <input type="file" id="fileInput" accept=".xls, .xlsx" #fileInput>
                <div class="drop-buttons">
                    <button id="convertir" (click)="convertir()">Añadir a la tabla</button>
                    <button id="deshacer" (click)="reset()">Deshacer cambios</button>
                </div>
            </div>
        </div>    
            
    </div>

    <div class="cont">
        <div class="nav_table">
            <button class="upload" (click)="subirDestinatarios()">Guardar</button>
            <button class="new_dif">Crear lista</button>
        </div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Rut</th>
                        <th>Dv rut</th>
                        <th>Nombre</th>
                        <th>Segundo Nombre</th>
                        <th>Apellido</th>
                        <th>Segundo Apellido</th>
                        <th>Email</th>
                        <th>Teléfono</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let destinatario of listDestProv">
                        <td>{{ destinatario.rut }}-{{ destinatario.dvrut | titlecase}}</td>
                        <td>{{ destinatario.nombre | titlecase }}</td>
                        <td>{{ destinatario.snombre | titlecase}}</td>
                        <td>{{ destinatario.appaterno | titlecase}}</td>
                        <td>{{ destinatario.apmaterno | titlecase }}</td>
                        <td class="email-container">{{ destinatario.email}}</td>
                        <td>{{ destinatario.telefono }}</td>
                        <td>
                            <button>
                                <i class="fas fa-save"></i>
                            </button>
                            <button>
                                <i class="fas fa-trash-alt"></i>
                            </button>
                            <button>
                                <i class="fas fa-edit"></i>
                            </button>
                        </td>
                    </tr>
                    <tr *ngIf="listDest.length === 0">
                        <td colspan="8">No hay destinatarios disponibles.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>